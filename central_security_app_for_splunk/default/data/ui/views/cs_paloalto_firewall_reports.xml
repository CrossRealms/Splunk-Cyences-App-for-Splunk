<form theme="light">
  <label>PaloAlto Firewall Reports</label>
  <fieldset submitButton="false">
    <input type="time" token="timeRange">
      <label>Time Range</label>
      <default>
        <earliest>-24h@h</earliest>
        <latest>now</latest>
      </default>
    </input>
  </fieldset>
  <row>
    <panel>
      <title>DDoS Attack Prevented by PaloAlto Firewall</title>
      <table>
        <search>
          <query>`cs_palo` sourcetype="pan:threat" log_subtype=packet | table _time, signature, dvc, dvc_name, src, src_location, dest, dest_location, action | `cs_palo_ddos_prevented_filter`</query>
          <earliest>$timeRange.earliest$</earliest>
          <latest>$timeRange.latest$</latest>
          <sampleRatio>1</sampleRatio>
        </search>
        <option name="count">10</option>
        <option name="drilldown">none</option>
        <option name="rowNumbers">true</option>
      </table>
      <html>
        <p>Description: PaloAlto Firewall prevented DDoS attack. It searches for log_subtype=packet.</p>
        <p>Data Collection: Palo Alto pan:traffic sourcetype's data. (Palo Alto Networks Add-on for Splunk)</p>
      </html>
    </panel>
  </row>
  <row>
    <panel>
      <title>PaloAlto Firewall Login Failures</title>
      <table>
        <search>
          <query>`cs_palo` sourcetype="pan:system" signature="auth-fail" object IN ("Local", "Local_Users") | rex "failed authentication for user \'(?&lt;user&gt;.*)\'\." | rex " From: (?&lt;src&gt;\d+\.\d+\.\d+\.\d+)" | table _time, dvc, dvc_name, user, src | `cs_palo_firewall_login_failure_filter`</query>
          <earliest>$timeRange.earliest$</earliest>
          <latest>$timeRange.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="rowNumbers">true</option>
      </table>
      <html>
        <p>Description: PaloAlto Firewall Logins on Local and Local_Users profile.</p>
        <p>Data Collection: Palo Alto pan:system sourcetype's data. (Palo Alto Networks Add-on for Splunk)</p>
      </html>
    </panel>
  </row>
</form>