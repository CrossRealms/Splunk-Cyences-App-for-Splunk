<form version="1.1" theme="dark">
  <label>Imperva WAF</label>
    <fieldset submitButton="false">
        <input type="time" token="timerange">
            <label>Time</label>
            <default>
                <earliest>-24h@h</earliest>
                <latest>now</latest>
            </default>
        </input>
    </fieldset>
    <row>
        <panel>
            <table>
            <title>Imperva WAF - Audit Logs</title>
            <search>
                <query>`cs_imperva_waf` sourcetype="imperva:waf"
| spath path=event.provider output=provider 
| spath path=event.dataset output=dataset  
| spath path=imperva.audit_trail.event_action output=event_action 
| spath path=imperva.audit_trail.event_action_description output=event_action_description 
| spath path=user.email output=user_email 
| where  dataset="AUDIT_TRAIL" 
| `cs_human_readble_time_format(_time, event_time)`
| table event_time provider event_action event_action_description user_email</query>
                <earliest>$timerange.earliest$</earliest>
                <latest>$timerange.latest$</latest>
                <sampleRatio>1</sampleRatio>
            </search>
            <option name="count">10</option>
            <option name="dataOverlayMode">none</option>
            <option name="drilldown">none</option>
            <option name="percentagesRow">false</option>
            <option name="rowNumbers">true</option>
            <option name="totalsRow">false</option>
            <option name="wrap">true</option>
            </table>
        </panel>
    </row>
</form>