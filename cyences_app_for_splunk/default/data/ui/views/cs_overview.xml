<form theme="dark">
  <label>Overview</label>
  <search id="basesearch">
    <query>`cs_cyences_index` | stats count as problems by category, alert_name | rename alert_name as savedsearch_name
| append [| rest /servicesNS/-/cyences_app_for_splunk/saved/searches count=0 splunk_server=local | search "eai:acl.app"="cyences_app_for_splunk" | fields title, disabled, is_scheduled | rename title as savedsearch_name]
| stats first(*) as * by savedsearch_name
| eval Problems=if(isnull(problems), 0, problems)
| search disabled=0 is_scheduled=1 
| `cs_daily_alerts`
| table savedsearch_name, Problems
| sort - Problems</query>
    <earliest>$timeRange.earliest$</earliest>
    <latest>$timeRange.latest$</latest>
    <sampleRatio>1</sampleRatio>
  </search>
  <fieldset submitButton="false">
    <input type="time" token="timeRange">
      <label>Time Range</label>
      <default>
        <earliest>-24h@h</earliest>
        <latest>now</latest>
      </default>
    </input>
  </fieldset>
  <row>
    <panel>
      <title>Network Compromise</title>
      <table>
        <search base="basesearch">
          <query>| `cs_filter_savedsearches("Network Compromise")`</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="disabled">
          <colorPalette type="map">{"1":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="is_scheduled">
          <colorPalette type="map">{"0":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="Problems">
          <colorPalette type="list">[#03991a,#a3030b]</colorPalette>
          <scale type="threshold">1</scale>
        </format>
        <fields>["Name","Problems"]</fields>
        <drilldown>
          <link target="_blank">/app/cyences_app_for_splunk/cs_forensics?form.tkn_savedsearch=$row.savedsearch_name$</link>
        </drilldown>
      </table>
    </panel>
    <panel>
      <title>Endpoint Compromise</title>
      <table>
        <search base="basesearch">
          <query>| `cs_filter_savedsearches("Endpoint Compromise")`</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="disabled">
          <colorPalette type="map">{"1":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="is_scheduled">
          <colorPalette type="map">{"0":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="Problems">
          <colorPalette type="list">[#03991a,#a3030b]</colorPalette>
          <scale type="threshold">1</scale>
        </format>
        <fields>["Name","Problems"]</fields>
        <drilldown>
          <link target="_blank">/app/cyences_app_for_splunk/cs_forensics?form.tkn_savedsearch=$row.savedsearch_name$</link>
        </drilldown>
      </table>
    </panel>
    <panel>
      <title>Credential Compromise</title>
      <table>
        <search base="basesearch">
          <query>| `cs_filter_savedsearches("Credential Compromise")`</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="disabled">
          <colorPalette type="map">{"1":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="is_scheduled">
          <colorPalette type="map">{"0":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="Problems">
          <colorPalette type="list">[#03991a,#a3030b]</colorPalette>
          <scale type="threshold">1</scale>
        </format>
        <fields>["Name","Problems"]</fields>
        <drilldown>
          <link target="_blank">/app/cyences_app_for_splunk/cs_forensics?form.tkn_savedsearch=$row.savedsearch_name$</link>
        </drilldown>
      </table>
    </panel>
    <panel>
      <title>Ransomware</title>
      <table>
        <search base="basesearch">
          <query>| `cs_filter_savedsearches("Ransomware")`</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="disabled">
          <colorPalette type="map">{"1":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="is_scheduled">
          <colorPalette type="map">{"0":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="Problems">
          <colorPalette type="list">[#03991a,#a3030b]</colorPalette>
          <scale type="threshold">1</scale>
        </format>
        <fields>["Name","Problems"]</fields>
        <drilldown>
          <link target="_blank">/app/cyences_app_for_splunk/cs_forensics?form.tkn_savedsearch=$row.savedsearch_name$</link>
        </drilldown>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Palo Alto Firewall</title>
      <table>
        <search base="basesearch">
          <query>| `cs_filter_savedsearches("Palo Alto Firewall")`</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="disabled">
          <colorPalette type="map">{"1":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="is_scheduled">
          <colorPalette type="map">{"0":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="Problems">
          <colorPalette type="list">[#03991a,#a3030b]</colorPalette>
          <scale type="threshold">1</scale>
        </format>
        <fields>["Name","Problems"]</fields>
        <drilldown>
          <link target="_blank">/app/cyences_app_for_splunk/cs_forensics?form.tkn_savedsearch=$row.savedsearch_name$&amp;form.timeRange.earliest=$timeRange.earliest$&amp;form.timeRange.latest=$timeRange.latest$</link>
        </drilldown>
      </table>
    </panel>
    <panel>
      <title>Active Directory &amp; Windows</title>
      <table>
        <search base="basesearch">
          <query>| `cs_filter_savedsearches("Windows|AD")`</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="disabled">
          <colorPalette type="map">{"1":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="is_scheduled">
          <colorPalette type="map">{"0":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="Problems">
          <colorPalette type="list">[#03991a,#a3030b]</colorPalette>
          <scale type="threshold">1</scale>
        </format>
        <fields>["Name","Problems"]</fields>
        <drilldown>
          <link target="_blank">/app/cyences_app_for_splunk/cs_forensics?form.tkn_savedsearch=$row.savedsearch_name$</link>
        </drilldown>
      </table>
    </panel>
    <panel>
      <title>O365</title>
      <table>
        <search base="basesearch">
          <query>| `cs_filter_savedsearches("O365")`</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="disabled">
          <colorPalette type="map">{"1":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="is_scheduled">
          <colorPalette type="map">{"0":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="Problems">
          <colorPalette type="list">[#03991a,#a3030b]</colorPalette>
          <scale type="threshold">1</scale>
        </format>
        <fields>["Name","Problems"]</fields>
        <drilldown>
          <link target="_blank">/app/cyences_app_for_splunk/cs_forensics?form.tkn_savedsearch=$row.savedsearch_name$</link>
        </drilldown>
      </table>
    </panel>
    <panel>
      <title>Antivirus</title>
      <table>
        <search base="basesearch">
          <query>| `cs_filter_savedsearches("Sophos|Windows Defender")`</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="disabled">
          <colorPalette type="map">{"1":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="is_scheduled">
          <colorPalette type="map">{"0":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="Problems">
          <colorPalette type="list">[#03991a,#a3030b]</colorPalette>
          <scale type="threshold">1</scale>
        </format>
        <fields>["Name","Problems"]</fields>
        <drilldown>
          <link target="_blank">/app/cyences_app_for_splunk/cs_forensics?form.tkn_savedsearch=$row.savedsearch_name$</link>
        </drilldown>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Splunk Admin</title>
      <table>
        <search base="basesearch">
          <query>| `cs_filter_savedsearches("Splunk Admin")`</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="disabled">
          <colorPalette type="map">{"1":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="is_scheduled">
          <colorPalette type="map">{"0":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="Problems">
          <colorPalette type="list">[#03991a,#a3030b]</colorPalette>
          <scale type="threshold">1</scale>
        </format>
        <fields>["Name","Problems"]</fields>
        <drilldown>
          <link target="_blank">/app/cyences_app_for_splunk/cs_forensics?form.tkn_savedsearch=$row.savedsearch_name$</link>
        </drilldown>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Monthly Alerts</title>
      <input type="time" token="timeRange_long">
        <label>Time Range</label>
        <default>
          <earliest>-30d@d</earliest>
          <latest>now</latest>
        </default>
      </input>
      <table>
        <search>
          <query>`cs_cyences_index` alert_name IN `cs_monthly_alerts`
| stats count as problems by category, alert_name | rename alert_name as savedsearch_name
| append [| rest /servicesNS/-/cyences_app_for_splunk/saved/searches count=0 splunk_server=local | search "eai:acl.app"="cyences_app_for_splunk" | rename title as savedsearch_name | fields savedsearch_name, disabled, is_scheduled]
| stats first(*) as * by savedsearch_name
| search savedsearch_name IN `cs_monthly_alerts`
| eval Problems=if(isnull(problems), 0, problems)
| search disabled=0 is_scheduled=1
| table savedsearch_name, Problems
| rename savedsearch_name as Name
| sort - Problems</query>
          <earliest>$timeRange_long.earliest$</earliest>
          <latest>$timeRange_long.latest$</latest>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="disabled">
          <colorPalette type="map">{"1":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="is_scheduled">
          <colorPalette type="map">{"0":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="Problems">
          <colorPalette type="list">[#03991a,#a3030b]</colorPalette>
          <scale type="threshold">1</scale>
        </format>
        <fields>["Name","Problems"]</fields>
        <drilldown>
          <link target="_blank">/app/cyences_app_for_splunk/cs_forensics?form.tkn_savedsearch=$row.savedsearch_name$&amp;form.timeRange.earliest=$timeRange_long.earliest$&amp;form.timeRange.latest=$timeRange_long.latest$</link>
        </drilldown>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Globally Detected Malicious IPs</title>
      <table>
        <search>
          <query>| inputlookup cs_malicious_ip_list.csv
| eval last_seen=strftime(last_seen, "%F %T") 
| sort - no_of_victims
| table ip, last_seen, no_of_victims, ip_location, description</query>
          <earliest>0</earliest>
          <latest></latest>
        </search>
        <option name="count">8</option>
        <option name="drilldown">none</option>
      </table>
      <html>
        <div>
          <p>For more information about the Malicious IP List, please click <a href="/app/cyences_app_for_splunk/cs_malicious_ip_list" target="_black">here</a>.</p>
        </div>
      </html>
    </panel>
  </row>
</form>