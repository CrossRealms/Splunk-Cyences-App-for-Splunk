<form theme="dark" stylesheet="cs_overview.css" script="cs_overview.js" version="1.1">
  <label>Overview</label>
  <init>
    <set token="tkn_not_triggered_alert_filter_1"> problems!=0</set>
    <set token="tkn_not_triggered_alert_filter_2"> | where Count &gt; 0</set>
    <set token="tkn_status_drilldown">form.tkn_status=Unassigned&amp;form.tkn_status=Assigned&amp;form.tkn_status=Under Investigation</set>
  </init>
  <search id="basesearch">
    <query>`cs_cyences_index` | eval cyences_severity = case(cyences_severity=="critical", 5, cyences_severity=="high", 4, cyences_severity=="medium", 3, cyences_severity=="low", 2, cyences_severity=="info", 1)
| search cyences_severity IN $tkn_severity$
| `cs_add_notable_event_editor_fields`
| search notable_event_status="BANANABANANA" OR notable_event_status IN $tkn_status$
| stats count as problems by alert_name, cyences_severity | rename alert_name as savedsearch_name
| join type=left savedsearch_name
    [| rest /servicesNS/-/cyences_app_for_splunk/saved/searches count=0 splunk_server=local 
    | fields title "action.cyences_notable_event_action.teams" "action.cyences_notable_event_action.products"
    | rename title as savedsearch_name, "action.cyences_notable_event_action.teams" as teams, "action.cyences_notable_event_action.products" as alert_products]
| append [| rest /servicesNS/-/cyences_app_for_splunk/saved/searches count=0 splunk_server=local | search "eai:acl.app"="cyences_app_for_splunk" "action.cyences_notable_event_action"="1" disabled=0 is_scheduled=1 | fields title "action.cyences_notable_event_action.teams" "action.cyences_notable_event_action.products"
| rename title as savedsearch_name, "action.cyences_notable_event_action.teams" as teams, "action.cyences_notable_event_action.products" as alert_products | eval cyences_severity="unknown"]
| stats first(*) as * by savedsearch_name, cyences_severity
| search NOT savedsearch_name IN `cs_monthly_alerts`
| sort savedsearch_name, cyences_severity
| streamstats count as newcount by savedsearch_name
| where (cyences_severity!="unknown" OR newcount=1)
| makemv delim="," teams
| eval teams=trim(teams)
| search $tkn_teams$
| makemv delim="," alert_products
| eval alert_products=trim(alert_products)
| eval problems=if(isnull(problems), 0, problems)
| eval cyences_severity=if(problems==0, 0, cyences_severity)
| search $tkn_not_triggered_alert_filter_1$
| eval problem = cyences_severity."|".problems
| rename problem as "Notable Events"
| sort - cyences_severity
| table savedsearch_name, "Notable Events", cyences_severity, alert_products</query>
    <earliest>$timeRange.earliest$</earliest>
    <latest>$timeRange.latest$</latest>
    <sampleRatio>1</sampleRatio>
  </search>
  <fieldset submitButton="false">
    <input type="time" token="timeRange">
      <label>Time Range</label>
      <default>
        <earliest>-24h@h</earliest>
        <latest>now</latest>
      </default>
    </input>
    <input type="multiselect" token="tkn_severity" searchWhenChanged="true">
      <label>Severity</label>
      <choice value="5">critical</choice>
      <choice value="4">high</choice>
      <choice value="3">medium</choice>
      <choice value="2">low</choice>
      <choice value="1">info</choice>
      <default>5,4,3,2,1</default>
      <prefix>(</prefix>
      <suffix>)</suffix>
      <valuePrefix>"</valuePrefix>
      <valueSuffix>"</valueSuffix>
      <delimiter>,</delimiter>
    </input>
    <input type="multiselect" token="tkn_status" searchWhenChanged="true">
      <label>Status</label>
      <choice value="Unassigned">Unassigned</choice>
      <choice value="Assigned">Assigned</choice>
      <choice value="Under Investigation">Under Investigation</choice>
      <choice value="Clean">Clean</choice>
      <choice value="Malicious">Malicious</choice>
      <prefix>(</prefix>
      <suffix>)</suffix>
      <valuePrefix>"</valuePrefix>
      <valueSuffix>"</valueSuffix>
      <delimiter>,</delimiter>
      <default>Unassigned,Assigned,Under Investigation</default>
      <change>
        <condition>
          <eval token="tkn_status_drilldown">"form.tkn_status=" . mvjoin(split(replace(trim(trim($tkn_status$, "("), ")"), "\"", ""), ","), "&amp;form.tkn_status=")</eval>
        </condition>
      </change>
    </input>
    <input type="multiselect" token="tkn_teams" searchWhenChanged="true">
      <label>Team</label>
      <choice value="*">All</choice>
      <choice value="SOC">SOC</choice>
      <choice value="Compliance">Compliance</choice>
      <default>*</default>
      <prefix>teams IN (</prefix>
      <suffix>)</suffix>
      <initialValue>*</initialValue>
      <valuePrefix>"</valuePrefix>
      <valueSuffix>"</valueSuffix>
      <delimiter>, </delimiter>
    </input>
    <input type="checkbox" token="tkn_not_triggered_alert_checkbox" searchWhenChanged="true">
      <label></label>
      <choice value="1">Hide Not Triggered Alerts</choice>
      <delimiter> </delimiter>
      <initialValue>1</initialValue>
      <change>
        <condition match="$tkn_not_triggered_alert_checkbox$==1">
          <set token="tkn_not_triggered_alert_filter_1">problems!=0</set>
          <set token="tkn_not_triggered_alert_filter_2">| where Count &gt; 0</set>
        </condition>
        <condition>
          <set token="tkn_not_triggered_alert_filter_1"></set>
          <set token="tkn_not_triggered_alert_filter_2"></set>
        </condition>
      </change>
    </input>
  </fieldset>
  <row>
    <panel>
      <title>Dashboards</title>
      <html>
        <div id="cyences_links">
        </div>
      </html>
    </panel>
  </row>
  <row>
    <panel depends="$authentication$">
      <title>Authentication</title>
      <table id="tbl_authentication">
        <search base="basesearch">
          <query>| `cs_filter_savedsearches("Authentication")`</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="disabled">
          <colorPalette type="map">{"1":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="is_scheduled">
          <colorPalette type="map">{"0":#F7BC38}</colorPalette>
        </format>
        <fields>["Name","Notable Events"]</fields>
        <drilldown>
          <link target="_blank">/app/cyences_app_for_splunk/cs_forensics?form.tkn_savedsearch=$row.savedsearch_name$&amp;form.timeRange.earliest=$timeRange.earliest$&amp;form.timeRange.latest=$timeRange.latest$&amp;form.tkn_severity=$row.cyences_severity$&amp;$tkn_status_drilldown|n$</link>
        </drilldown>
      </table>
    </panel>
    <panel depends="$vpn$">
      <title>VPN</title>
      <table id="tbl_vpn">
        <search base="basesearch">
          <query>| `cs_filter_savedsearches("VPN")`</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="disabled">
          <colorPalette type="map">{"1":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="is_scheduled">
          <colorPalette type="map">{"0":#F7BC38}</colorPalette>
        </format>
        <fields>["Name","Notable Events"]</fields>
        <drilldown>
          <link target="_blank">/app/cyences_app_for_splunk/cs_forensics?form.tkn_savedsearch=$row.savedsearch_name$&amp;form.timeRange.earliest=$timeRange.earliest$&amp;form.timeRange.latest=$timeRange.latest$&amp;form.tkn_severity=$row.cyences_severity$&amp;$tkn_status_drilldown|n$</link>
        </drilldown>
      </table>
    </panel>
    <panel depends="$radius_authentication$">
      <title>Radius Authentication</title>
      <table id="tbl_radius_authentication">
        <search base="basesearch">
          <query>| `cs_filter_savedsearches("Radius Authentication")`</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="disabled">
          <colorPalette type="map">{"1":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="is_scheduled">
          <colorPalette type="map">{"0":#F7BC38}</colorPalette>
        </format>
        <fields>["Name","Notable Events"]</fields>
        <drilldown>
          <link target="_blank">/app/cyences_app_for_splunk/cs_forensics?form.tkn_savedsearch=$row.savedsearch_name$&amp;form.timeRange.earliest=$timeRange.earliest$&amp;form.timeRange.latest=$timeRange.latest$&amp;form.tkn_severity=$row.cyences_severity$&amp;$tkn_status_drilldown|n$</link>
        </drilldown>
      </table>
    </panel>
  </row>
  <row>
    <panel depends="$crowdstrike_eventstream$">
      <title>CrowdStrike EventStream</title>
      <table id="tbl_crowdstrike_eventstream">
        <search base="basesearch">
          <query>| `cs_filter_savedsearches("CrowdStrike EventStream")`</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="disabled">
          <colorPalette type="map">{"1":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="is_scheduled">
          <colorPalette type="map">{"0":#F7BC38}</colorPalette>
        </format>
        <fields>["Name","Notable Events"]</fields>
        <drilldown>
          <link target="_blank">/app/cyences_app_for_splunk/cs_forensics?form.tkn_savedsearch=$row.savedsearch_name$&amp;form.timeRange.earliest=$timeRange.earliest$&amp;form.timeRange.latest=$timeRange.latest$&amp;form.tkn_severity=$row.cyences_severity$&amp;$tkn_status_drilldown|n$</link>
        </drilldown>
      </table>
    </panel>
    <panel depends="$sophos$">
      <title>Sophos Endpoint Protection</title>
      <table id="tbl_sophos">
        <search base="basesearch">
          <query>| `cs_filter_savedsearches("Sophos Endpoint Protection")`
| eval Count=if(isnull(problems), 0, problems)
| rename savedsearch_name as Name
| eval Name=case(Name=="Endpoint Protection Service is Not Running","Sophos Endpoint Protection Service Stopped/Disabled Events",Name=="Endpoint RealTime Protection Disabled","Sophos Endpoint Protection RealTime Protection Stopped/Disabled Events",true(),Name)
| append 
    [| search `cs_sophos` type IN ("Event::Endpoint::ServiceNotRunning", "Event::Endpoint::ServiceRestored") dhost IN ("*") user IN ("*") earliest=$timeRange.earliest$ latest=$timeRange.latest$
    | fields _time host dhost type 
    | stats latest(type) as type by host, dhost 
    | where type=="Event::Endpoint::ServiceNotRunning" 
    | stats count as Count
    $tkn_not_triggered_alert_filter_2$
    | search [| search `cs_sophos` earliest=$timeRange.earliest$ latest=$timeRange.latest$ | head 1 | stats count | eval search=if(count&gt;0, "", "sourcetype=DONOTRETURNANYRESULTS") | fields search | return $search]
    | eval Name="Currently Disabled/Stopped Sophos Endpoint Protection Services"
    | eval cyences_severity = 4, teams="SOC"
    | makemv delim="," teams
    | eval teams=trim(teams)
    | search cyences_severity IN $tkn_severity$ AND $tkn_teams$] 
| append
    [| search `cs_sophos` type="Event::Endpoint::Sav*" host="*" dhost IN ("*") user IN ("*") earliest=$timeRange.earliest$ latest=$timeRange.latest$
    | fields host dhost type 
    | stats latest(type) as type by host, dhost 
    | where type=="Event::Endpoint::SavDisabled" 
    | stats count as Count
    $tkn_not_triggered_alert_filter_2$
    | search [| search `cs_sophos` earliest=$timeRange.earliest$ latest=$timeRange.latest$ | head 1 | stats count | eval search=if(count&gt;0, "", "sourcetype=DONOTRETURNANYRESULTS") | fields search | return $search]
    | eval Name="Currently Stopped/Disabled Sophos Endpoint RealTime Protection"
    | eval cyences_severity = 4, teams="SOC"
    | makemv delim="," teams
    | eval teams=trim(teams)
    | search cyences_severity IN $tkn_severity$ AND $tkn_teams$]
| eval cyences_severity=if(Count==0, 0, cyences_severity)
| sort - cyences_severity
| eval problem = cyences_severity."|".Count
| rename problem as "Notable Events"
| table savedsearch_name, Name, "Notable Events", cyences_severity</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="disabled">
          <colorPalette type="map">{"1":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="is_scheduled">
          <colorPalette type="map">{"0":#F7BC38}</colorPalette>
        </format>
        <fields>["Name","Notable Events"]</fields>
        <drilldown>
          <condition match="'row.Name'==&quot;Currently Disabled/Stopped Sophos Endpoint Protection Services&quot;">
            <link target="_blank">/app/cyences_app_for_splunk/cs_sophos_reports?form.timeRange.earliest=$timeRange.earliest$&amp;form.timeRange.latest=$timeRange.latest$</link>
          </condition>
          <condition match="'row.Name'==&quot;Currently Stopped/Disabled Sophos Endpoint RealTime Protection&quot;">
            <link target="_blank">/app/cyences_app_for_splunk/cs_sophos_reports?form.timeRange.earliest=$timeRange.earliest$&amp;form.timeRange.latest=$timeRange.latest$</link>
          </condition>
          <condition>
            <link target="_blank">/app/cyences_app_for_splunk/cs_forensics?form.tkn_savedsearch=$row.savedsearch_name$&amp;form.timeRange.earliest=$timeRange.earliest$&amp;form.timeRange.latest=$timeRange.latest$&amp;form.tkn_severity=$row.cyences_severity$&amp;$tkn_status_drilldown|n$</link>
          </condition>
        </drilldown>
      </table>
    </panel>
    <panel depends="$windows_defender$">
      <title>Windows Defender</title>
      <table id="tbl_windows_defender">
        <search base="basesearch">
          <query>| `cs_filter_savedsearches("Windows Defender")`
| eval Count=if(isnull(problems), 0, problems)
| rename savedsearch_name as Name
| eval Name=case(Name=="Endpoint Not Protected","Windows Defender Endpoint Stopped/Disabled Events",Name=="RealTime Protection Disabled or Failed","Windows Defender RealTime Protection Stopped/Disabled/Failed Events",true(),Name)
| append
    [| search ((`cs_wineventlog_system` SourceName="Microsoft-Windows-Service Control Manager" Message="The Windows Defender Antivirus Service service entered the *" Message=stopped) OR (`cs_windows_defender` EventCode IN (1150, 1151))) earliest=$timeRange.earliest$ latest=$timeRange.latest$ 
      | fields EventCode, host 
      | stats latest(EventCode) as EventCode by host 
      | stats count(eval(EventCode!=1150 AND EventCode!=1151)) as Count 
      $tkn_not_triggered_alert_filter_2$
      | search [| search `cs_windows_defender` earliest=$timeRange.earliest$ latest=$timeRange.latest$ | head 1 | stats count | eval search=if(count&gt;0, "", "sourcetype=DONOTRETURNANYRESULTS") | fields search | return $search]
      | eval Name="Currently Disabled/Stopped Windows Defender Services"
    | eval cyences_severity = 4, teams="SOC"
    | makemv delim="," teams
    | eval teams=trim(teams)
    | search cyences_severity IN $tkn_severity$ AND $tkn_teams$]
| append
    [| search `cs_windows_defender` EventCode=1151  earliest=$timeRange.earliest$ latest=$timeRange.latest$ 
    | fields RTP_state host 
    | stats latest(RTP_state) as RTP_state by host 
    | where RTP_state=="Disabled" 
    | stats count as Count 
    $tkn_not_triggered_alert_filter_2$
    | search [| search `cs_windows_defender` earliest=$timeRange.earliest$ latest=$timeRange.latest$ | head 1 | stats count | eval search=if(count&gt;0, "", "sourcetype=DONOTRETURNANYRESULTS") | fields search | return $search]
    | eval Name="Currently Stopped/Disabled Windows Defender RealTime Protection"
    | eval cyences_severity = 4, teams="SOC"
    | makemv delim="," teams
    | eval teams=trim(teams)
    | search cyences_severity IN $tkn_severity$ AND $tkn_teams$]
| eval cyences_severity=if(Count==0, 0, cyences_severity)
| sort - cyences_severity
| eval problem = cyences_severity."|".Count
| rename problem as "Notable Events"
| table savedsearch_name, Name, "Notable Events", cyences_severity</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="disabled">
          <colorPalette type="map">{"1":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="is_scheduled">
          <colorPalette type="map">{"0":#F7BC38}</colorPalette>
        </format>
        <fields>["Name","Notable Events"]</fields>
        <drilldown>
          <condition match="'row.Name'==&quot;Windows Defender - RealTime Protection Disabled or Failed&quot;">
            <link target="_blank">/app/cyences_app_for_splunk/cs_windows_defender_reports?form.timeRange.earliest=$timeRange.earliest$&amp;form.timeRange.latest=$timeRange.latest$</link>
          </condition>
          <condition match="'row.Name'==&quot;Currently Disabled/Stopped Windows Defender Services&quot;">
            <link target="_blank">/app/cyences_app_for_splunk/cs_windows_defender_reports?form.timeRange.earliest=$timeRange.earliest$&amp;form.timeRange.latest=$timeRange.latest$</link>
          </condition>
          <condition match="'row.Name'==&quot;Currently Stopped/Disabled Windows Defender RealTime Protection&quot;">
            <link target="_blank">/app/cyences_app_for_splunk/cs_windows_defender_reports?form.timeRange.earliest=$timeRange.earliest$&amp;form.timeRange.latest=$timeRange.latest$</link>
          </condition>
          <condition match="'row.Name'==&quot;Defender ATP - Alerts&quot;">
            <link target="_blank">/app/cyences_app_for_splunk/cs_o365_defender_atp?form.timeRange.earliest=$timeRange.earliest$&amp;form.timeRange.latest=$timeRange.latest$</link>
          </condition>
          <condition>
            <link target="_blank">/app/cyences_app_for_splunk/cs_forensics?form.tkn_savedsearch=$row.savedsearch_name$&amp;form.timeRange.earliest=$timeRange.earliest$&amp;form.timeRange.latest=$timeRange.latest$&amp;form.tkn_severity=$row.cyences_severity$&amp;$tkn_status_drilldown|n$</link>
          </condition>
        </drilldown>
      </table>
    </panel>
    <panel depends="$o365_defender_atp$">
      <title>Office 365 Defender ATP</title>
      <table id="tbl_o365_defender_atp">
        <search base="basesearch">
          <query>| `cs_filter_savedsearches("Office 365 Defender ATP")`</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="disabled">
          <colorPalette type="map">{"1":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="is_scheduled">
          <colorPalette type="map">{"0":#F7BC38}</colorPalette>
        </format>
        <fields>["Name","Notable Events"]</fields>
        <drilldown>
          <condition match="'row.Name'==&quot;Defender ATP - Alerts&quot;">
            <link target="_blank">/app/cyences_app_for_splunk/cs_o365_defender_atp?form.timeRange.earliest=$timeRange.earliest$&amp;form.timeRange.latest=$timeRange.latest$</link>
          </condition>
          <condition>
            <link target="_blank">/app/cyences_app_for_splunk/cs_forensics?form.tkn_savedsearch=$row.savedsearch_name$&amp;form.timeRange.earliest=$timeRange.earliest$&amp;form.timeRange.latest=$timeRange.latest$&amp;form.tkn_severity=$row.cyences_severity$&amp;$tkn_status_drilldown|n$</link>
          </condition>
        </drilldown>
      </table>
    </panel>
  </row>
  <row>
    <panel depends="$aws$">
      <title>AWS</title>
      <table id="tbl_aws">
        <search base="basesearch">
          <query>| `cs_filter_savedsearches("AWS")`</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="disabled">
          <colorPalette type="map">{"1":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="is_scheduled">
          <colorPalette type="map">{"0":#F7BC38}</colorPalette>
        </format>
        <fields>["Name","Notable Events"]</fields>
        <drilldown>
          <link target="_blank">/app/cyences_app_for_splunk/cs_forensics?form.tkn_savedsearch=$row.savedsearch_name$&amp;form.timeRange.earliest=$timeRange.earliest$&amp;form.timeRange.latest=$timeRange.latest$&amp;form.tkn_severity=$row.cyences_severity$&amp;$tkn_status_drilldown|n$</link>
        </drilldown>
      </table>
    </panel>
    <panel depends="$gws$">
      <title>Google Workspace</title>
      <table id="tbl_gws">
        <search base="basesearch">
          <query>| `cs_filter_savedsearches("Google Workspace")`</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="disabled">
          <colorPalette type="map">{"1":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="is_scheduled">
          <colorPalette type="map">{"0":#F7BC38}</colorPalette>
        </format>
        <fields>["Name","Notable Events"]</fields>
        <drilldown>
          <link target="_blank">/app/cyences_app_for_splunk/cs_forensics?form.tkn_savedsearch=$row.savedsearch_name$&amp;form.timeRange.earliest=$timeRange.earliest$&amp;form.timeRange.latest=$timeRange.latest$&amp;form.tkn_severity=$row.cyences_severity$&amp;$tkn_status_drilldown|n$</link>
        </drilldown>
      </table>
    </panel>
    <panel depends="$o365$">
      <title>Office 365</title>
      <table id="tbl_o365">
        <search base="basesearch">
          <query>| `cs_filter_savedsearches("Office 365")` 
| append 
    [| search `cs_o365` (sourcetype="o365:service:healthIssue" OR (sourcetype="o365:service:status" source="*CurrentStatus"))  earliest=$timeRange.earliest$ latest=$timeRange.latest$
    | eval Status = coalesce(status, Status), Service = coalesce(service, WorkloadDisplayName) 
    | stats latest(Status) as Status latest(_time) as _time by Service host 
    | search Status IN ("ExtendedRecovery","InformationUnavailable","Investigating*","RestoringService","ServiceDegradation","ServiceInterruption") 
    | stats count as Count
    $tkn_not_triggered_alert_filter_2$
    | search [| search `cs_o365` earliest=$timeRange.earliest$ latest=$timeRange.latest$ | head 1 | stats count | eval search=if(count&gt;0, "", "sourcetype=DONOTRETURNANYRESULTS") | fields search | return $search]
    | eval Name="Currently not Operational O365 Services"
    | eval cyences_severity=3, teams="Compliance"
    | makemv delim="," teams
    | eval teams=trim(teams)
    | search cyences_severity IN $tkn_severity$ AND $tkn_teams$
    | eval Count = cyences_severity."|".Count
    | rename Count as "Notable Events"]
| sort - cyences_severity</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="disabled">
          <colorPalette type="map">{"1":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="is_scheduled">
          <colorPalette type="map">{"0":#F7BC38}</colorPalette>
        </format>
        <fields>["Name","Notable Events"]</fields>
        <drilldown>
          <condition match="'row.Name'==&quot;Currently not Operational O365 Services&quot;">
            <link target="_blank">/app/cyences_app_for_splunk/cs_o365_reports?form.timeRange.earliest=$timeRange.earliest$&amp;form.timeRange.latest=$timeRange.latest$</link>
          </condition>
          <condition>
            <link target="_blank">/app/cyences_app_for_splunk/cs_forensics?form.tkn_savedsearch=$row.savedsearch_name$&amp;form.timeRange.earliest=$timeRange.earliest$&amp;form.timeRange.latest=$timeRange.latest$&amp;form.tkn_severity=$row.cyences_severity$&amp;$tkn_status_drilldown|n$</link>
          </condition>
        </drilldown>
      </table>
    </panel>
    <panel depends="$email$">
      <title>Email</title>
      <table id="tbl_email">
        <search base="basesearch">
          <query>| `cs_filter_savedsearches("Email")`</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="disabled">
          <colorPalette type="map">{"1":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="is_scheduled">
          <colorPalette type="map">{"0":#F7BC38}</colorPalette>
        </format>
        <fields>["Name","Notable Events"]</fields>
        <drilldown>
          <link target="_blank">/app/cyences_app_for_splunk/cs_forensics?form.tkn_savedsearch=$row.savedsearch_name$&amp;form.timeRange.earliest=$timeRange.earliest$&amp;form.timeRange.latest=$timeRange.latest$&amp;form.tkn_severity=$row.cyences_severity$&amp;$tkn_status_drilldown|n$</link>
        </drilldown>
      </table>
    </panel>
  </row>
  <row>
    <panel depends="$network_compromise$">
      <title>Network Compromise</title>
      <table id="tbl_network_compromise">
        <search base="basesearch">
          <query>| `cs_filter_savedsearches("Network")`</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="disabled">
          <colorPalette type="map">{"1":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="is_scheduled">
          <colorPalette type="map">{"0":#F7BC38}</colorPalette>
        </format>
        <fields>["Name","Notable Events"]</fields>
        <drilldown>
          <link target="_blank">/app/cyences_app_for_splunk/cs_forensics?form.tkn_savedsearch=$row.savedsearch_name$&amp;form.timeRange.earliest=$timeRange.earliest$&amp;form.timeRange.latest=$timeRange.latest$&amp;form.tkn_severity=$row.cyences_severity$&amp;$tkn_status_drilldown|n$</link>
        </drilldown>
      </table>
    </panel>
    <panel depends="$cisco_ios$">
      <title>Cisco IOS</title>
      <table id="tbl_cisco_ios">
        <search base="basesearch">
          <query>| `cs_filter_savedsearches("Cisco IOS")`</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="disabled">
          <colorPalette type="map">{"1":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="is_scheduled">
          <colorPalette type="map">{"0":#F7BC38}</colorPalette>
        </format>
        <fields>["Name","Notable Events"]</fields>
        <drilldown>
          <link target="_blank">/app/cyences_app_for_splunk/cs_forensics?form.tkn_savedsearch=$row.savedsearch_name$&amp;form.timeRange.earliest=$timeRange.earliest$&amp;form.timeRange.latest=$timeRange.latest$&amp;form.tkn_severity=$row.cyences_severity$&amp;$tkn_status_drilldown|n$</link>
        </drilldown>
      </table>
    </panel>
    <panel depends="$fortigate$">
      <title>FortiGate</title>
      <table id="tbl_fortigate">
        <search base="basesearch">
          <query>| `cs_filter_savedsearches("FortiGate")`</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="disabled">
          <colorPalette type="map">{"1":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="is_scheduled">
          <colorPalette type="map">{"0":#F7BC38}</colorPalette>
        </format>
        <fields>["Name","Notable Events"]</fields>
        <drilldown>
          <link target="_blank">/app/cyences_app_for_splunk/cs_forensics?form.tkn_savedsearch=$row.savedsearch_name$&amp;form.timeRange.earliest=$timeRange.earliest$&amp;form.timeRange.latest=$timeRange.latest$&amp;form.tkn_severity=$row.cyences_severity$&amp;$tkn_status_drilldown|n$</link>
        </drilldown>
      </table>
    </panel>
    <panel depends="$cloudflare$">
      <title>Cloudflare</title>
      <table id="tbl_cloudflare">
        <search base="basesearch">
          <query>| `cs_filter_savedsearches("Cloudflare")`</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="disabled">
          <colorPalette type="map">{"1":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="is_scheduled">
          <colorPalette type="map">{"0":#F7BC38}</colorPalette>
        </format>
        <fields>["Name","Notable Events"]</fields>
        <drilldown>
          <link target="_blank">/app/cyences_app_for_splunk/cs_forensics?form.tkn_savedsearch=$row.savedsearch_name$&amp;form.timeRange.earliest=$timeRange.earliest$&amp;form.timeRange.latest=$timeRange.latest$&amp;form.tkn_severity=$row.cyences_severity$&amp;$tkn_status_drilldown|n$</link>
        </drilldown>
      </table>
    </panel>
  </row>
  <row>
    <panel depends="$palo_alto$">
      <title>Palo Alto</title>
      <table id="tbl_palo_alto">
        <search base="basesearch">
          <query>| `cs_filter_savedsearches("Palo Alto")`</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="disabled">
          <colorPalette type="map">{"1":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="is_scheduled">
          <colorPalette type="map">{"0":#F7BC38}</colorPalette>
        </format>
        <fields>["Name","Notable Events"]</fields>
        <drilldown>
          <link target="_blank">/app/cyences_app_for_splunk/cs_forensics?form.tkn_savedsearch=$row.savedsearch_name$&amp;form.timeRange.earliest=$timeRange.earliest$&amp;form.timeRange.latest=$timeRange.latest$&amp;form.tkn_severity=$row.cyences_severity$&amp;$tkn_status_drilldown|n$</link>
        </drilldown>
      </table>
    </panel>
    <panel depends="$sophos_firewall$">
      <title>Sophos Firewall</title>
      <table id="tbl_sophos_firewall">
        <search base="basesearch">
          <query>| `cs_filter_savedsearches("Sophos Firewall")`</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="disabled">
          <colorPalette type="map">{"1":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="is_scheduled">
          <colorPalette type="map">{"0":#F7BC38}</colorPalette>
        </format>
        <fields>["Name","Notable Events"]</fields>
        <drilldown>
          <link target="_blank">/app/cyences_app_for_splunk/cs_forensics?form.tkn_savedsearch=$row.savedsearch_name$&amp;form.timeRange.earliest=$timeRange.earliest$&amp;form.timeRange.latest=$timeRange.latest$&amp;form.tkn_severity=$row.cyences_severity$&amp;$tkn_status_drilldown|n$</link>
        </drilldown>
      </table>
    </panel>
    <panel depends="$cisco_meraki$">
      <title>Cisco Meraki</title>
      <table id="tbl_cisco_meraki">
        <search base="basesearch">
          <query>| `cs_filter_savedsearches("Cisco Meraki")`</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="disabled">
          <colorPalette type="map">{"1":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="is_scheduled">
          <colorPalette type="map">{"0":#F7BC38}</colorPalette>
        </format>
        <fields>["Name","Notable Events"]</fields>
        <drilldown>
          <link target="_blank">/app/cyences_app_for_splunk/cs_forensics?form.tkn_savedsearch=$row.savedsearch_name$&amp;form.timeRange.earliest=$timeRange.earliest$&amp;form.timeRange.latest=$timeRange.latest$&amp;form.tkn_severity=$row.cyences_severity$&amp;$tkn_status_drilldown|n$</link>
        </drilldown>
      </table>
    </panel>
    <panel depends="$f5_bigip$">
      <title>F5 BIGIP</title>
      <table id="tbl_f5_bigip">
        <search base="basesearch">
          <query>| `cs_filter_savedsearches("F5 BIGIP")`</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="disabled">
          <colorPalette type="map">{"1":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="is_scheduled">
          <colorPalette type="map">{"0":#F7BC38}</colorPalette>
        </format>
        <fields>["Name","Notable Events"]</fields>
        <drilldown>
          <link target="_blank">/app/cyences_app_for_splunk/cs_forensics?form.tkn_savedsearch=$row.savedsearch_name$&amp;form.timeRange.earliest=$timeRange.earliest$&amp;form.timeRange.latest=$timeRange.latest$&amp;form.tkn_severity=$row.cyences_severity$&amp;$tkn_status_drilldown|n$</link>
        </drilldown>
      </table>
    </panel>
    <panel depends="$imperva_waf$">
      <title>Imperva WAF</title>
      <table id="tbl_imperva_waf">
        <search base="basesearch">
          <query>| `cs_filter_savedsearches("Imperva WAF")`</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="disabled">
          <colorPalette type="map">{"1":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="is_scheduled">
          <colorPalette type="map">{"0":#F7BC38}</colorPalette>
        </format>
        <fields>["Name","Notable Events"]</fields>
        <drilldown>
          <link target="_blank">/app/cyences_app_for_splunk/cs_forensics?form.tkn_savedsearch=$row.savedsearch_name$&amp;form.timeRange.earliest=$timeRange.earliest$&amp;form.timeRange.latest=$timeRange.latest$&amp;form.tkn_severity=$row.cyences_severity$&amp;$tkn_status_drilldown|n$</link>
        </drilldown>
      </table>
    </panel>
    <panel depends="$imperva_dam$">
      <title>Imperva DAM</title>
      <table id="tbl_imperva_dam">
        <search base="basesearch">
          <query>| `cs_filter_savedsearches("Imperva DAM")`</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="disabled">
          <colorPalette type="map">{"1":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="is_scheduled">
          <colorPalette type="map">{"0":#F7BC38}</colorPalette>
        </format>
        <fields>["Name","Notable Events"]</fields>
        <drilldown>
          <link target="_blank">/app/cyences_app_for_splunk/cs_forensics?form.tkn_savedsearch=$row.savedsearch_name$&amp;form.timeRange.earliest=$timeRange.earliest$&amp;form.timeRange.latest=$timeRange.latest$&amp;form.tkn_severity=$row.cyences_severity$&amp;$tkn_status_drilldown|n$</link>
        </drilldown>
      </table>
    </panel>
  </row>
  <row>
    <panel depends="$windows$">
      <title>Windows</title>
      <table id="tbl_windows">
        <search base="basesearch">
          <query>| `cs_filter_savedsearches("Windows")`</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="disabled">
          <colorPalette type="map">{"1":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="is_scheduled">
          <colorPalette type="map">{"0":#F7BC38}</colorPalette>
        </format>
        <fields>["Name","Notable Events"]</fields>
        <drilldown>
          <link target="_blank">/app/cyences_app_for_splunk/cs_forensics?form.tkn_savedsearch=$row.savedsearch_name$&amp;form.timeRange.earliest=$timeRange.earliest$&amp;form.timeRange.latest=$timeRange.latest$&amp;form.tkn_severity=$row.cyences_severity$&amp;$tkn_status_drilldown|n$</link>
        </drilldown>
      </table>
    </panel>
    <panel depends="$ad_windows$">
      <title>Active Directory</title>
      <table id="tbl_ad_windows">
        <search base="basesearch">
          <query>| `cs_filter_savedsearches("Windows AD")`</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="disabled">
          <colorPalette type="map">{"1":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="is_scheduled">
          <colorPalette type="map">{"0":#F7BC38}</colorPalette>
        </format>
        <fields>["Name","Notable Events"]</fields>
        <drilldown>
          <link target="_blank">/app/cyences_app_for_splunk/cs_forensics?form.tkn_savedsearch=$row.savedsearch_name$&amp;form.timeRange.earliest=$timeRange.earliest$&amp;form.timeRange.latest=$timeRange.latest$&amp;form.tkn_severity=$row.cyences_severity$&amp;$tkn_status_drilldown|n$</link>
        </drilldown>
      </table>
    </panel>
    <panel depends="$sysmon$">
      <title>Sysmon</title>
      <table id="tbl_sysmon">
        <search base="basesearch">
          <query>| `cs_filter_savedsearches("Sysmon")`</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="disabled">
          <colorPalette type="map">{"1":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="is_scheduled">
          <colorPalette type="map">{"0":#F7BC38}</colorPalette>
        </format>
        <fields>["Name","Notable Events"]</fields>
        <drilldown>
          <link target="_blank">/app/cyences_app_for_splunk/cs_forensics?form.tkn_savedsearch=$row.savedsearch_name$&amp;form.timeRange.earliest=$timeRange.earliest$&amp;form.timeRange.latest=$timeRange.latest$&amp;form.tkn_severity=$row.cyences_severity$&amp;$tkn_status_drilldown|n$</link>
        </drilldown>
      </table>
    </panel>
    <panel depends="$duo$">
      <title>DUO</title>
      <table id="tbl_duo">
        <search base="basesearch">
          <query>| `cs_filter_savedsearches("DUO")`</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="disabled">
          <colorPalette type="map">{"1":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="is_scheduled">
          <colorPalette type="map">{"0":#F7BC38}</colorPalette>
        </format>
        <fields>["Name","Notable Events"]</fields>
        <drilldown>
          <link target="_blank">/app/cyences_app_for_splunk/cs_forensics?form.tkn_savedsearch=$row.savedsearch_name$&amp;form.timeRange.earliest=$timeRange.earliest$&amp;form.timeRange.latest=$timeRange.latest$&amp;form.tkn_severity=$row.cyences_severity$&amp;$tkn_status_drilldown|n$</link>
        </drilldown>
      </table>
    </panel>
  </row>
  <row>
    <panel depends="$linux$">
      <title>Linux/Unix</title>
      <table id="tbl_linux">
        <search base="basesearch">
          <query>| `cs_filter_savedsearches("Linux")`</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="disabled">
          <colorPalette type="map">{"1":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="is_scheduled">
          <colorPalette type="map">{"0":#F7BC38}</colorPalette>
        </format>
        <fields>["Name","Notable Events"]</fields>
        <drilldown>
          <link target="_blank">/app/cyences_app_for_splunk/cs_forensics?form.tkn_savedsearch=$row.savedsearch_name$&amp;form.timeRange.earliest=$timeRange.earliest$&amp;form.timeRange.latest=$timeRange.latest$&amp;form.tkn_severity=$row.cyences_severity$&amp;$tkn_status_drilldown|n$</link>
        </drilldown>
      </table>
    </panel>
    <panel depends="$vulnerability$">
      <title>Vulnerability</title>
      <table id="tbl_vulnerability">
        <search base="basesearch">
          <query>| `cs_filter_savedsearches("Vulnerability")`</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="disabled">
          <colorPalette type="map">{"1":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="is_scheduled">
          <colorPalette type="map">{"0":#F7BC38}</colorPalette>
        </format>
        <fields>["Name","Notable Events"]</fields>
        <drilldown>
          <link target="_blank">/app/cyences_app_for_splunk/cs_forensics?form.tkn_savedsearch=$row.savedsearch_name$&amp;form.timeRange.earliest=$timeRange.earliest$&amp;form.timeRange.latest=$timeRange.latest$&amp;form.tkn_severity=$row.cyences_severity$&amp;$tkn_status_drilldown|n$</link>
        </drilldown>
      </table>
    </panel>
    <panel depends="$db_oracle$">
      <title>Oracle Database</title>
      <table id="tbl_db_oracle">
        <search base="basesearch">
          <query>| `cs_filter_savedsearches("Oracle")`</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="disabled">
          <colorPalette type="map">{"1":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="is_scheduled">
          <colorPalette type="map">{"0":#F7BC38}</colorPalette>
        </format>
        <fields>["Name","Notable Events"]</fields>
        <drilldown>
          <link target="_blank">/app/cyences_app_for_splunk/cs_forensics?form.tkn_savedsearch=$row.savedsearch_name$&amp;form.timeRange.earliest=$timeRange.earliest$&amp;form.timeRange.latest=$timeRange.latest$&amp;form.tkn_severity=$row.cyences_severity$&amp;$tkn_status_drilldown|n$</link>
        </drilldown>
      </table>
    </panel>
    <panel depends="$db_mssql$">
      <title>MSSQL Database</title>
      <table id="tbl_db_mssql">
        <search base="basesearch">
          <query>| `cs_filter_savedsearches("MSSQL")`</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="disabled">
          <colorPalette type="map">{"1":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="is_scheduled">
          <colorPalette type="map">{"0":#F7BC38}</colorPalette>
        </format>
        <fields>["Name","Notable Events"]</fields>
        <drilldown>
          <link target="_blank">/app/cyences_app_for_splunk/cs_forensics?form.tkn_savedsearch=$row.savedsearch_name$&amp;form.timeRange.earliest=$timeRange.earliest$&amp;form.timeRange.latest=$timeRange.latest$&amp;form.tkn_severity=$row.cyences_severity$&amp;$tkn_status_drilldown|n$</link>
        </drilldown>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Monthly Alerts</title>
      <input type="time" token="timeRange_long">
        <label>Time Range</label>
        <default>
          <earliest>-30d@d</earliest>
          <latest>now</latest>
        </default>
      </input>
      <table id="tbl_monthly_alerts">
        <search>
          <query>`cs_cyences_index` alert_name IN `cs_monthly_alerts` | eval cyences_severity = case(cyences_severity=="critical", 5, cyences_severity=="high", 4, cyences_severity=="medium", 3, cyences_severity=="low", 2, cyences_severity=="info", 1)
| search cyences_severity IN $tkn_severity$
| `cs_add_notable_event_editor_fields`
| search notable_event_status="BANANABANANA" OR notable_event_status IN $tkn_status$
| stats count as problems by alert_name, cyences_severity | rename alert_name as savedsearch_name
| join type=left savedsearch_name
    [| rest /servicesNS/-/cyences_app_for_splunk/saved/searches count=0 splunk_server=local 
    | fields title "action.cyences_notable_event_action.teams" "action.cyences_notable_event_action.products"
    | rename title as savedsearch_name, "action.cyences_notable_event_action.teams" as teams, "action.cyences_notable_event_action.products" as alert_products]
| append [| rest /servicesNS/-/cyences_app_for_splunk/saved/searches count=0 splunk_server=local | search "eai:acl.app"="cyences_app_for_splunk" "action.cyences_notable_event_action"="1" disabled=0 is_scheduled=1 | fields title "action.cyences_notable_event_action.teams" "action.cyences_notable_event_action.products" 
| rename title as savedsearch_name, "action.cyences_notable_event_action.teams" as teams, "action.cyences_notable_event_action.products" as alert_products | eval cyences_severity="unknown"]
| stats first(*) as * by savedsearch_name, cyences_severity
| search savedsearch_name IN `cs_monthly_alerts`
| sort savedsearch_name, cyences_severity
| streamstats count as newcount by savedsearch_name
| where (cyences_severity!="unknown" OR newcount=1)
| makemv delim="," teams
| eval teams=trim(teams)
| search $tkn_teams$
| makemv delim="," alert_products
| eval alert_products=trim(alert_products)
| eval problems=if(isnull(problems), 0, problems)
| eval cyences_severity=if(problems==0, 0, cyences_severity)
| search $tkn_not_triggered_alert_filter_1$
| eval problem = cyences_severity."|".problems
| sort - cyences_severity
| rename savedsearch_name as Name, problem as "Notable Events"
| table Name, "Notable Events", cyences_severity, alert_products</query>
          <earliest>$timeRange_long.earliest$</earliest>
          <latest>$timeRange_long.latest$</latest>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="disabled">
          <colorPalette type="map">{"1":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="is_scheduled">
          <colorPalette type="map">{"0":#F7BC38}</colorPalette>
        </format>
        <fields>["Name","Notable Events"]</fields>
        <drilldown>
          <link target="_blank">/app/cyences_app_for_splunk/cs_forensics?form.tkn_savedsearch=$row.Name$&amp;form.timeRange.earliest=$timeRange_long.earliest$&amp;form.timeRange.latest=$timeRange_long.latest$&amp;form.tkn_severity=$row.cyences_severity$&amp;$tkn_status_drilldown|n$</link>
        </drilldown>
      </table>
    </panel>
  </row>
  <row depends="$other_alerts_panel$">
    <panel>
      <title>Other Alerts</title>
      <table id="tbl_other_alerts">
        <search base="basesearch">
          <query> eval products_to_search="Authentication|VPN|Radius Authentication|Sophos Endpoint Protection|Windows Defender|CrowdStrike EventStream|Office 365 Defender ATP|AWS|Google Workspace|Office 365|Email|Network|Cisco IOS|FortiGate|Palo Alto|Sophos Firewall|Cisco Meraki|F5 BIGIP|Cloudflare|Vulnerability|Windows|Windows AD|Sysmon|Linux|Oracle|MSSQL|DUO"
| makemv delim="|" products_to_search | eval products_to_search=trim(products_to_search)
| cyencesmvintersection set1="products_to_search" set2="alert_products"
| where mvcount(intersection)=0
| rex field=savedsearch_name "^.*\-\s(?&lt;Name&gt;.*)$"
| eval Name=if(isnull(Name), savedsearch_name, Name)</query>
          <progress>
            <condition match="'job.resultCount' &gt; 0">
              <set token="other_alerts_panel">true</set>
            </condition>
            <condition>
              <unset token="other_alerts_panel"></unset>
            </condition>
          </progress>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="disabled">
          <colorPalette type="map">{"1":#F7BC38}</colorPalette>
        </format>
        <format type="color" field="is_scheduled">
          <colorPalette type="map">{"0":#F7BC38}</colorPalette>
        </format>
        <fields>["Name","Notable Events"]</fields>
        <drilldown>
          <link target="_blank">/app/cyences_app_for_splunk/cs_forensics?form.tkn_savedsearch=$row.savedsearch_name$&amp;form.timeRange.earliest=$timeRange.earliest$&amp;form.timeRange.latest=$timeRange.latest$&amp;form.tkn_severity=$row.cyences_severity$&amp;$tkn_status_drilldown|n$</link>
        </drilldown>
      </table>
    </panel>
  </row>
</form>