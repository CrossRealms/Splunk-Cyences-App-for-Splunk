<form version="1.1" theme="dark">
  <label>Linux Users/Groups Status</label>
  <fieldset submitButton="false">
    <input type="time" token="field1">
      <label></label>
      <default>
        <earliest>0</earliest>
        <latest></latest>
      </default>
    </input>
    <input type="text" token="tkn_host">
      <label>Host</label>
      <default>*</default>
      <initialValue>*</initialValue>
    </input>
  </fieldset>
  <row>
    <panel>
      <title>Linux Group Added/Updated/Removed</title>
      <input type="text" token="tkn_group">
        <label>Group</label>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="multiselect" token="tkn_actions">
        <label>Action</label>
        <choice value="*">All</choice>
        <choice value="*added*">Added</choice>
        <choice value="*removed*">Removed</choice>
        <choice value="*updated*">Updated</choice>
        <delimiter>,</delimiter>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <table>
        <search>
          <query>| inputlookup cs_linux_groups_list.csv 
| stats latest(*) as * latest(_time) as _time by host group_name
| search status IN ($tkn_actions$) host="*$tkn_host$*" group_name="*$tkn_group$*"
| addinfo 
| eval info_max_time=if(info_max_time="+Infinity",now(),info_max_time) 
| where _time&gt;info_min_time AND info_max_time&gt;_time 
| fields - info_* 
| table _time host group_name users status</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="drilldown">cell</option>
        <option name="refresh.display">progressbar</option>
        <drilldown>
          <set token="group_show_panel">1</set>
          <set token="group_host">$row.host$</set>
          <set token="group_name">$row.group_name$</set>
        </drilldown>
      </table>
    </panel>
  </row>
  <row depends="$group_show_panel$">
    <panel>
      <title>Group History</title>
      <table>
        <title>HostName="$group_host$"  GroupName="$group_name$"</title>
        <search>
          <query>| inputlookup cs_linux_groups_list.csv | search host="$group_host$" group_name="$group_name$" | sort 0 - _time | table _time host group_name users status </query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="drilldown">none</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Linux User Added/Updated/Removed</title>
      <input type="text" token="tkn_user">
        <label>User</label>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="multiselect" token="tkn_actions_users">
        <label>Action</label>
        <choice value="*">All</choice>
        <choice value="*added*">Added</choice>
        <choice value="*removed*">Removed</choice>
        <choice value="*updated*">Updated</choice>
        <delimiter>,</delimiter>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <table>
        <search>
          <query>| inputlookup cs_linux_users_new_list.csv 
| stats latest(*) as * latest(_time) as _time by host UID 
| search status IN ($tkn_actions_users$)  host="*$tkn_host$*" USERNAME="*$tkn_user$*" 
| addinfo 
| eval info_max_time=if(info_max_time="+Infinity",now(),info_max_time) 
| where _time&gt;info_min_time AND info_max_time&gt;_time 
| fields - info_* 
| table _time host USERNAME UID GID HOME_DIR COMMAND_SHELL USER_INFO SUDOACCESS status</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <drilldown>
          <set token="user_show_panel">1</set>
          <set token="user_host">$row.host$</set>
          <set token="UID_name">$row.UID$</set>
          <set token="user_name">$row.USERNAME$</set>
        </drilldown>
        <option name="refresh.display">progressbar</option>
      </table>
    </panel>
  </row>
  <row depends="$user_show_panel$">
    <panel>
      <title>User History</title>
      <table>
        <title>HostName="$user_host$" UserName="$user_name$"</title>
        <search>
          <query>| inputlookup cs_linux_users_new_list.csv  | search host="$user_host$" UID="$UID_name$" | sort 0 - _time | table _time host USERNAME UID GID HOME_DIR COMMAND_SHELL USER_INFO SUDOACCESS status</query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="drilldown">none</option>
      </table>
    </panel>
  </row>
</form>