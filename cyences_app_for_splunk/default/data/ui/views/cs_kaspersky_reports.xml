<form theme="dark" version="1.1">
  <label>Kaspersky</label>
  <fieldset submitButton="false">
    <input type="time" token="tkn_timerange">
      <label></label>
      <default>
        <earliest>-24h@h</earliest>
        <latest>now</latest>
      </default>
    </input>
  </fieldset>
  <row>
    <panel>
      <title>Attack Detected</title>
      <table>
        <search>
          <query>`cs_kaspersky_index` tag=malware tag=attack  log_type=GNRL_EV_ATTACK_DETECTED | table dest  application action AttackName Attack* signature TaskName user user_domain url</query>
          <earliest>$tkn_timerange.earliest$</earliest>
          <latest>$tkn_timerange.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Virus Found</title>
      <table>
        <search>
          <query>`cs_kaspersky_index` tag=malware tag=attack  log_type=GNRL_EV_VIRUS_FOUND | table _time dest VirusName  category action VirusName TaskName msg user user_domain</query>
          <earliest>$tkn_timerange.earliest$</earliest>
          <latest>$tkn_timerange.latest$</latest>
        </search>
        <option name="drilldown">none</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Virus Found and Passwd</title>
      <table>
        <search>
          <query>`cs_kaspersky_index` tag=malware tag=attack  log_type=GNRL_EV_VIRUS_FOUND_AND_PASSED | table _time dest   category  VirusName TaskName msg user user_domain</query>
          <earliest>$tkn_timerange.earliest$</earliest>
          <latest>$tkn_timerange.latest$</latest>
        </search>
        <option name="drilldown">none</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Virus Found and Bloacked</title>
      <table>
        <search>
          <query>`cs_kaspersky_index` tag=malware tag=attack  log_type=GNRL_EV_VIRUS_FOUND_AND_BLOCKED | table _time dest VirusName  category action VirusName TaskName msg user user_domain</query>
          <earliest>$tkn_timerange.earliest$</earliest>
          <latest>$tkn_timerange.latest$</latest>
        </search>
        <option name="drilldown">none</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Application Database out of Date</title>
      <table>
        <search>
          <query>`cs_kaspersky_index`  log_type=GNRL_EV_ANTIVIRAL_BASES_EXPIRED TERM(GNRL_EV_ANTIVIRAL_BASES_EXPIRED) | table  _time dest ProductName ProductVersion msg</query>
          <earliest>$tkn_timerange.earliest$</earliest>
          <latest>$tkn_timerange.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Suspicious Object Found</title>
      <table>
        <search>
          <query>`cs_kaspersky_index` tag=malware tag=attack  log_type=GNRL_EV_SUSPICIOUS_OBJECT_FOUND TERM(GNRL_EV_SUSPICIOUS_OBJECT_FOUND) | table  _time dest ProductName ProductVersion  user  VirusName   TaskName msg</query>
          <earliest>$tkn_timerange.earliest$</earliest>
          <latest>$tkn_timerange.latest$</latest>
        </search>
        <option name="drilldown">none</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Object Blocked</title>
      <table>
        <search>
          <query>`cs_kaspersky_index` tag=malware tag=attack  log_type=GNRL_EV_OBJECT_BLOCKED | table _time dest user category action signature TaskName msg</query>
          <earliest>$tkn_timerange.earliest$</earliest>
          <latest>$tkn_timerange.latest$</latest>
        </search>
        <option name="drilldown">none</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Object Deleted</title>
      <table>
        <search>
          <query>`cs_kaspersky_index` tag=malware tag=attack  log_type=GNRL_EV_OBJECT_DELETED | table _time dest user category action signature TaskName msg</query>
          <earliest>$tkn_timerange.earliest$</earliest>
          <latest>$tkn_timerange.latest$</latest>
        </search>
        <option name="drilldown">none</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Object Not Cured</title>
      <table>
        <search>
          <query>`cs_kaspersky_index` tag=malware tag=attack  log_type=GNRL_EV_OBJECT_NOTCURED | table _time dest user category   TaskName msg</query>
          <earliest>$tkn_timerange.earliest$</earliest>
          <latest>$tkn_timerange.latest$</latest>
        </search>
        <option name="drilldown">none</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Kaspersky Centralized Server Errors</title>
      <table>
        <search>
          <query>`cs_kaspersky_index` tag=malware tag=attack  log_type=GNRL_EV_OBJECT_NOTCURED | table _time dest user category   TaskName msg</query>
          <earliest>$tkn_timerange.earliest$</earliest>
          <latest>$tkn_timerange.latest$</latest>
        </search>
        <option name="drilldown">none</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Kaspersky Runtime Errors</title>
      <table>
        <search>
          <query>`cs_kaspersky_index`  log_type IN (KLSRV_RUNTIME_ERROR)| dedup msg ProductName ProductVersion | table _time dest ProductName ProductVersion  msg</query>
          <earliest>$tkn_timerange.earliest$</earliest>
          <latest>$tkn_timerange.latest$</latest>
        </search>
        <option name="drilldown">none</option>
      </table>
    </panel>
  </row>
</form>